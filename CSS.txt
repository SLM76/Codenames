const words = [
  "Ø£ÙˆØ¯ÙŠÙ†", "Ø­Ø±Ø¨", "Ù†Ø§Ø±", "Ù…Ø·Ø±Ù‚Ø©", "Ø«ÙˆØ±", "Ù…ØµÙŠØ±", "Ø´ÙØ±Ø©", "Ø­ÙƒÙ…Ø©",
  "Ø¯Ù…", "Ø³ÙŠÙ", "Ø±Ø¹Ø¯", "Ø¸Ù„Ø§Ù…", "Ø±Ù…Ø²", "Ø¹Ù‡Ø¯", "Ø¶ÙˆØ¡", "Ø­Ø±Ø§Ø³Ø©",
  "Ù„Ø¹Ù†Ø©", "Ø¨ÙˆØ§Ø¨Ø©", "Ù‚ÙˆØ©", "Ù…Ø¹Ø¨Ø¯", "ØªÙ†ÙŠÙ†", "Ø´Ù…Ø³", "Ø¹ÙŠÙ†", "Ø­Ø±Ø¨Ø§Ø¡", "ØµØ®Ø±Ø©"
];

let roles = [];
let revealedCount = { red: 0, blue: 0 };
let board, gameStatus, hintArea;
let showRoles = false;

window.onload = () => {
  board = document.getElementById("gameBoard");
  gameStatus = document.getElementById("gameStatus");
  hintArea = document.getElementById("hintArea");
  setupGame();
};

function setupGame() {
  board.innerHTML = '';
  gameStatus.textContent = '';
  hintArea.textContent = '';
  revealedCount = { red: 0, blue: 0 };
  const shuffled = words.sort(() => 0.5 - Math.random()).slice(0, 25);
  roles = [...Array(9).fill('red'), ...Array(8).fill('blue'), ...Array(7).fill('neutral'), 'assassin'].sort(() => 0.5 - Math.random());

  shuffled.forEach((word, i) => {
    const card = document.createElement('div');
    card.className = 'card';
    card.dataset.role = roles[i];
    card.innerHTML = `<div class="cover"></div>${word}`;

    card.addEventListener('click', () => {
      if (card.classList.contains('revealed')) return;

      const role = card.dataset.role;
      card.classList.add('revealed', role);
      document.getElementById("clickSound").play();

      if (role === 'red') revealedCount.red++;
      if (role === 'blue') revealedCount.blue++;
      if (role === 'assassin') {
        gameStatus.textContent = 'ðŸ’€ Ù„Ù‚Ø¯ Ø§Ø®ØªØ±ØªÙ… Ø§Ù„Ù‚Ø§ØªÙ„! Ø§Ù„Ù†Ù‡Ø§ÙŠØ©.';
        document.getElementById("loseSound").play();
        revealAll();
      } else {
        checkVictory();
      }
    });

    board.appendChild(card);
  });
}

function showHint() {
  const hint = document.getElementById("hintInput").value;
  const number = document.getElementById("hintNumber").value;
  if (!hint || !number) {
    alert("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„ØªÙ„Ù…ÙŠØ­ ÙˆØ§Ù„Ø¹Ø¯Ø¯.");
    return;
  }
  hintArea.textContent = `ðŸ§  Ø§Ù„ØªÙ„Ù…ÙŠØ­: "${hint}" â€“ Ø¹Ø¯Ø¯: ${number}`;
}

function checkVictory() {
  if (revealedCount.red === 9) {
    gameStatus.textContent = 'ðŸŽ‰ Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ø­Ù…Ø± ÙØ§Ø²!';
    document.getElementById("winSound").play();
    revealAll();
  }
  if (revealedCount.blue === 8) {
    gameStatus.textContent = 'ðŸŽ‰ Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ø²Ø±Ù‚ ÙØ§Ø²!';
    document.getElementById("winSound").play();
    revealAll();
  }
}

function revealAll() {
  document.querySelectorAll('.card').forEach((card, i) => {
    card.classList.add(roles[i], 'revealed');
  });
}

function toggleRoles() {
  showRoles = !showRoles;
  document.querySelectorAll('.card').forEach((card, i) => {
    if (!card.classList.contains('revealed')) {
      if (showRoles) {
        card.classList.add(roles[i]);
      } else {
        card.classList.remove('red', 'blue', 'neutral', 'assassin');
      }
    }
  });
}

function resetGame() {
  setupGame();
}
